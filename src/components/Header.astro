---
import CTAButton from "./CTAButton.astro";

const phoneE164 = "+61481422769";
const pathname = Astro.url.pathname;

const base = import.meta.env.BASE_URL;

const isActive = (href: string) =>
  pathname === href || pathname.startsWith(href + "/");
---

<header class="gcc-header">
  <div class="gcc-container gcc-header-inner">
    <div class="flex items-center justify-between gap-6">
      <!-- Logo -->
      <a href={base || "/"} class="gcc-logo">
        <img
          src={`${base}/images/gcc-logo.png`}
          alt="GCC Melbourne Logo"
          width="180"
          height="60"
          class="gcc-logo-mark"
          loading="eager"
        />

        <span class="gcc-wordmark" aria-label="Green Commercial Cleaning">
          <span class="line1">GREEN</span>
          <span class="line2">COMMERCIAL</span>
          <span class="line3">CLEANING</span>
        </span>

        <span class="sr-only">Green Commercial Cleaning</span>
      </a>

      <!-- Desktop Nav -->
      <nav class="gcc-nav hidden md:flex items-center gap-6">
        <!-- Services dropdown -->
        <div class="gcc-dropdown">
          <a
            href={`${base}/services`}
            class="gcc-dropdown-trigger"
            aria-current={isActive(`${base}/services`) ? "page" : undefined}
          >
            Services <span class="gcc-caret">▾</span>
          </a>

          <div class="gcc-dropdown-menu">
            <a href={`${base}/services/office-cleaning`}>Office Cleaning</a>
            <a href={`${base}/services/medical-centre-cleaning`}
              >Medical Centre Cleaning</a
            >
            <a href={`${base}/services/warehouse-cleaning`}
              >Warehouse Cleaning</a
            >
          </div>
        </div>

        <!-- Areas dropdown -->
        <div class="gcc-dropdown">
          <a
            href={`${base}/areas`}
            class="gcc-dropdown-trigger"
            aria-current={isActive(`${base}/areas`) ? "page" : undefined}
          >
            Areas <span class="gcc-caret">▾</span>
          </a>

          <div class="gcc-dropdown-menu">
            <a href={`${base}/areas/melbourne-cbd`}>Melbourne CBD</a>
            <a href={`${base}/areas/southbank`}>Southbank</a>
            <a href={`${base}/areas/richmond`}>Richmond</a>
            <a href={`${base}/areas/south-yarra`}>South Yarra</a>
          </div>
        </div>

        <a
          href={`${base}/about`}
          aria-current={isActive(`${base}/about`) ? "page" : undefined}>About</a
        >
        <a
          href={`${base}/pricing`}
          aria-current={isActive(`${base}/pricing`) ? "page" : undefined}
          >Pricing</a
        >
      </nav>

      <!-- Desktop CTAs -->
      <div class="hidden md:flex items-center gap-3">
        <CTAButton
          href={`${base}/contact`}
          label="Get a Quote"
          variant="primary"
          icon="quote"
        />
        <CTAButton
          href={`tel:${phoneE164}`}
          label="Call Us"
          variant="outline"
          icon="phone"
        />
      </div>

      <!-- Mobile Hamburger + Drawer -->
      <div class="md:hidden">
        <input type="checkbox" id="gcc-menu-toggle" />

        <label
          for="gcc-menu-toggle"
          class="gcc-hamburger"
          aria-label="Open menu"
        >
          <span></span><span></span><span></span>
        </label>

        <!-- Overlay (click to close) -->
        <label
          for="gcc-menu-toggle"
          class="gcc-drawer-overlay"
          aria-hidden="true"></label>

        <!-- Drawer -->
        <aside class="gcc-drawer" aria-label="Mobile menu">
          <nav class="gcc-drawer-nav">
            <!-- Services accordion -->
            <details class="gcc-mobile-dd">
              <summary class="gcc-mobile-dd-trigger">
                Services <span class="gcc-mobile-dd-caret">▾</span>
              </summary>
              <div class="gcc-mobile-dd-panel">
                <a href={`${base}/services`}>All Services</a>
                <a href={`${base}/services/office-cleaning`}>Office Cleaning</a>
                <a href={`${base}/services/medical-centre-cleaning`}
                  >Medical Centre Cleaning</a
                >
                <a href={`${base}/services/warehouse-cleaning`}
                  >Warehouse Cleaning</a
                >
              </div>
            </details>

            <!-- Areas accordion -->
            <details class="gcc-mobile-dd">
              <summary class="gcc-mobile-dd-trigger">
                Areas <span class="gcc-mobile-dd-caret">▾</span>
              </summary>
              <div class="gcc-mobile-dd-panel">
                <a href={`${base}/areas`}>All Areas</a>
                <a href={`${base}/areas/melbourne-cbd`}>Melbourne CBD</a>
                <a href={`${base}/areas/southbank`}>Southbank</a>
                <a href={`${base}/areas/richmond`}>Richmond</a>
                <a href={`${base}/areas/south-yarra`}>South Yarra</a>
              </div>
            </details>

            <!-- Normal links -->
            <a class="gcc-drawer-link" href={`${base}/about`}>About</a>
            <a class="gcc-drawer-link" href={`${base}/pricing`}>Pricing</a>
            <a class="gcc-drawer-link" href={`${base}/contact`}>Contact</a>
          </nav>
        </aside>
      </div>
    </div>
  </div>
</header>
