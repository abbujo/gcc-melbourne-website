---
import CTAButton from "./CTAButton.astro";

const phoneE164 = "+61481422769";
const pathname = Astro.url.pathname;

const isActive = (href: string) =>
  pathname === href || pathname.startsWith(href + "/");
---

<header class="gcc-header">
  <div class="gcc-container gcc-header-inner">
    <div class="flex items-center justify-between gap-6">
      <!-- Logo -->
      <a href="/" class="gcc-logo">
        <img
          src="/images/gcc-logo.png"
          alt=""
          width="44"
          height="44"
          class="gcc-logo-mark"
          loading="eager"
        />

        <span class="gcc-wordmark" aria-label="Green Commercial Cleaning">
          <span class="line1">GREEN</span>
          <span class="line2">COMMERCIAL</span>
          <span class="line3">CLEANING</span>
        </span>

        <span class="sr-only">Green Commercial Cleaning</span>
      </a>

      <!-- Desktop Nav -->
      <nav class="gcc-nav hidden md:flex items-center gap-6">
        <!-- Services dropdown -->
        <div class="gcc-dropdown">
          <a
            href="/services"
            class="gcc-dropdown-trigger"
            aria-current={isActive("/services") ? "page" : undefined}
          >
            Services <span class="gcc-caret">▾</span>
          </a>

          <div class="gcc-dropdown-menu">
            <a href="/services/office-cleaning">Office Cleaning</a>
            <a href="/services/medical-centre-cleaning"
              >Medical Centre Cleaning</a
            >
            <a href="/services/warehouse-cleaning">Warehouse Cleaning</a>
          </div>
        </div>

        <!-- Areas dropdown -->
        <div class="gcc-dropdown">
          <a
            href="/areas"
            class="gcc-dropdown-trigger"
            aria-current={isActive("/areas") ? "page" : undefined}
          >
            Areas <span class="gcc-caret">▾</span>
          </a>

          <div class="gcc-dropdown-menu">
            <a href="/areas/melbourne-cbd">Melbourne CBD</a>
            <a href="/areas/southbank">Southbank</a>
            <a href="/areas/richmond">Richmond</a>
            <a href="/areas/south-yarra">South Yarra</a>
          </div>
        </div>

        <a href="/about" aria-current={isActive("/about") ? "page" : undefined}
          >About</a
        >
        <a
          href="/pricing"
          aria-current={isActive("/pricing") ? "page" : undefined}>Pricing</a
        >
      </nav>

      <!-- Desktop CTAs -->
      <div class="hidden md:flex items-center gap-3">
        <CTAButton
          href="/contact"
          label="Get a Quote"
          variant="primary"
          icon="quote"
        />
        <CTAButton
          href={`tel:${phoneE164}`}
          label="Call Us"
          variant="outline"
          icon="phone"
        />
      </div>

      <!-- Mobile Hamburger + Drawer -->
      <div class="md:hidden">
        <input type="checkbox" id="gcc-menu-toggle" />

        <label
          for="gcc-menu-toggle"
          class="gcc-hamburger"
          aria-label="Open menu"
        >
          <span></span><span></span><span></span>
        </label>

        <!-- Overlay (click to close) -->
        <label
          for="gcc-menu-toggle"
          class="gcc-drawer-overlay"
          aria-hidden="true"></label>

        <!-- Drawer -->
        <aside class="gcc-drawer" aria-label="Mobile menu">
          <nav class="gcc-drawer-nav">
            <!-- Services accordion -->
            <details class="gcc-mobile-dd">
              <summary class="gcc-mobile-dd-trigger">
                Services <span class="gcc-mobile-dd-caret">▾</span>
              </summary>
              <div class="gcc-mobile-dd-panel">
                <a href="/services">All Services</a>
                <a href="/services/office-cleaning">Office Cleaning</a>
                <a href="/services/medical-centre-cleaning"
                  >Medical Centre Cleaning</a
                >
                <a href="/services/warehouse-cleaning">Warehouse Cleaning</a>
              </div>
            </details>

            <!-- Areas accordion -->
            <details class="gcc-mobile-dd">
              <summary class="gcc-mobile-dd-trigger">
                Areas <span class="gcc-mobile-dd-caret">▾</span>
              </summary>
              <div class="gcc-mobile-dd-panel">
                <a href="/areas">All Areas</a>
                <a href="/areas/melbourne-cbd">Melbourne CBD</a>
                <a href="/areas/southbank">Southbank</a>
                <a href="/areas/richmond">Richmond</a>
                <a href="/areas/south-yarra">South Yarra</a>
              </div>
            </details>

            <!-- Normal links -->
            <a class="gcc-drawer-link" href="/about">About</a>
            <a class="gcc-drawer-link" href="/pricing">Pricing</a>
            <a class="gcc-drawer-link" href="/contact">Contact</a>
          </nav>
        </aside>
      </div>
    </div>
  </div>
</header>
