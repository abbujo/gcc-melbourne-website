---
interface Props {
  title?: string;
  description?: string;
  canonical?: string;
  ogImage?: string;
}

const {
  title = "GCC Melbourne | Commercial Cleaning",
  description = "Commercial cleaning services in Melbourne, VIC.",
} = Astro.props;

const siteBase = Astro.site
  ? Astro.site.origin
  : "https://www.gccmelbourne.com.au";
const canonicalURL = new URL(Astro.url.pathname, Astro.site || siteBase);

const titleProp = Astro.props.title ?? title;
const descriptionProp = Astro.props.description ?? description;
const canonicalProp = Astro.props.canonical ?? canonicalURL.href;

// Ensure og:image includes the base path if it's the default
const base = import.meta.env.BASE_URL; // e.g., "/gcc-melbourne-website" or "/"
// Helper to construct absolute URL with base
function getAbsoluteUrl(path: string) {
  if (path.startsWith("http")) return path;
  // If path starts with /, remove it to append to base which might not have it, or handle cleanly
  const cleanPath = path.startsWith("/") ? path.slice(1) : path;
  // If base is just "/" then we don't want double //
  const cleanBase = base === "/" ? "" : base;
  return new URL(`${cleanBase}/${cleanPath}`, Astro.site || siteBase).href;
}

const ogImageProp = Astro.props.ogImage ?? getAbsoluteUrl("og.jpg");
---

<title>{titleProp}</title>
<meta name="description" content={descriptionProp} />
<link rel="canonical" href={canonicalProp} />

<meta property="og:type" content="website" />
<meta property="og:title" content={titleProp} />
<meta property="og:description" content={descriptionProp} />
<meta property="og:url" content={canonicalProp} />
<meta property="og:image" content={ogImageProp} />

<meta name="twitter:card" content="summary_large_image" />
